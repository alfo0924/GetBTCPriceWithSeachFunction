<!DOCTYPE html>
<html>
<head>
  <title>Live Bitcoin Chart</title>

  <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>

  <style>
    body{
      padding: 150px;
      background-color: rgba(222, 222, 222, 0.74);
      background-blend-mode: multiply;
      align-items: center;
      text-decoration: none;
      align-content: center;
      justify-content: center;
      text-align: center;
      text-transform: uppercase;

    }
  </style>
</head>
<body>

<h1>bitcoin</h1>

<div class="tradingview-widget-container">
  <div id="tradingview_12345"></div>
</div>

<br>
<br>

<!-- Date input fields and search button -->
<label for="startDate">Start Date:</label>
<input type="date" id="startDate" name="startDate">
<label for="endDate">End Date:</label>
<input type="date" id="endDate" name="endDate">
<button onclick="searchByDateRange()">Search</button>

<!-- Container to display queried data -->
<div id="pricesContainer"></div>

<!-- JavaScript for handling date range search and displaying data -->
<script>
  function searchByDateRange() {
    var startDate = document.getElementById("startDate").value;
    var endDate = document.getElementById("endDate").value;

    console.log("Start Date:", startDate);
    console.log("End Date:", endDate);

    fetch(`/search?startDate=${startDate}&endDate=${endDate}`)
            .then(response => response.json())
            .then(data => {
              console.log("Response Data:", data);
              displayData(data, startDate, endDate); // Pass startDate and endDate to displayData function
            })
            .catch(error => console.error('Error:', error));
  }

  function displayData(data, startDate, endDate) {
    var pricesContainer = document.getElementById("pricesContainer");
    pricesContainer.innerHTML = "";

    // Display the selected date range
    var dateRangeElement = document.createElement("p");
    dateRangeElement.textContent = `Date Range: ${startDate} to ${endDate}`;
    pricesContainer.appendChild(dateRangeElement);

    // Display queried data
    data.forEach(price => {
      var priceElement = document.createElement("p");
      priceElement.textContent = `Price: ${price.price}, Date: ${price.date}`;
      pricesContainer.appendChild(priceElement);
    });
  }
</script>






<!-- Initialize TradingView chart -->
<script type="text/javascript">
  new TradingView.widget({
    "width": 980,
    "height": 610,
    "symbol": "BTCUSD",
    "interval": "D",
    "timezone": "Asia/Taipei",  <!-- Changed timezone to Asia/Taipei -->
    "theme": "light",
    "style": "1",
    "locale": "en",
    "toolbar_bg": "#f1f3f6",
    "enable_publishing": false,
    "allow_symbol_change": true,
    "container_id": "tradingview_12345"
  });
</script>


</body>
</html>
